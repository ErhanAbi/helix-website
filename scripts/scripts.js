export function sampleRUM(e,t={}){try{if(window.hlx=window.hlx||{},!window.hlx.rum){const e="on"===new URLSearchParams(window.location.search).get("rum")?1:100,t=`${(e=>e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0))(window.location.href)}-${(new Date).getTime()}-${Math.random().toString(16).substr(2,14)}`,o=Math.random(),a=o*e<1;window.hlx.rum={weight:e,id:t,random:o,isSelected:a}}const{random:o,weight:a,id:n}=window.hlx.rum;if(o&&o*a<1){const o=()=>{const o=JSON.stringify({weight:a,id:n,referer:window.location.href,generation:RUM_GENERATION,checkpoint:e,...t}),c=`https://rum.hlx3.page/.rum/${a}`;navigator.sendBeacon(c,o)};o(),"cwv"===e&&import("./web-vitals-module-2-1-2.js").then((e=>{const a=e=>{t.cwv={},t.cwv[e.name]=e.value,o()};e.getCLS(a),e.getFID(a),e.getLCP(a)}))}}catch(e){}}export function loadCSS(e,t){if(document.querySelector(`head > link[href="${e}"]`))"function"==typeof t&&t("noop");else{const o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),"function"==typeof t&&(o.onload=e=>t(e.type),o.onerror=e=>t(e.type)),document.head.appendChild(o)}}export function getMetadata(e){const t=e&&e.includes(":")?"property":"name",o=document.head.querySelector(`meta[${t}="${e}"]`);return o&&o.content}export function addPublishDependencies(e){const t=Array.isArray(e)?e:[e];window.hlx=window.hlx||{},window.hlx.dependencies&&Array.isArray(window.hlx.dependencies)?window.hlx.dependencies=window.hlx.dependencies.concat(t):window.hlx.dependencies=t}export function toClassName(e){return e&&"string"==typeof e?e.toLowerCase().replace(/[^0-9a-z]/gi,"-"):""}export function decorateBlock(e){const t=e.classList[0];if(t){e.classList.add("block"),e.setAttribute("data-block-name",t),e.setAttribute("data-block-status","initialized");e.parentElement.classList.add(`${t}-wrapper`)}}export function readBlockConfig(e){const t={};return e.querySelectorAll(":scope>div").forEach((e=>{if(e.children){const o=[...e.children];if(o[1]){const a=o[1],n=toClassName(o[0].textContent);let c="";if(a.querySelector("a")){const e=[...a.querySelectorAll("a")];c=1===e.length?e[0].href:e.map((e=>e.href))}else if(a.querySelector("p")){const e=[...a.querySelectorAll("p")];c=1===e.length?e[0].textContent:e.map((e=>e.textContent))}else c=a.querySelector("img")?a.querySelector("img").src:e.children[1].textContent;t[n]=c}}})),t}export function decorateSections(e){e.querySelectorAll(":scope > div").forEach((e=>{const t=[];let o=!1;[...e.children].forEach((e=>{if("DIV"===e.tagName||!o){const a=document.createElement("div");o="DIV"!==e.tagName,o&&(a.className="default-content-wrapper"),t.push(a)}t[t.length-1].append(e)})),t.forEach((t=>e.append(t))),e.classList.add("section"),e.setAttribute("data-section-status","initialized");const a=e.querySelector("div.section-metadata");if(a){const t=readBlockConfig(a);Object.keys(t).forEach((o=>{"style"===o?e.classList.add(toClassName(t.style)):e.dataset[o]=t[o]})),a.remove()}}))}export function updateSectionsStatus(e){const t=[...e.querySelectorAll(":scope > div.section")];for(let e=0;e<t.length;e+=1){const o=t[e];if("loaded"!==o.getAttribute("data-section-status")){if(o.querySelector('.block[data-block-status="initialized"], .block[data-block-status="loading"]')){o.setAttribute("data-section-status","loading");break}o.setAttribute("data-section-status","loaded")}}}export function decorateBlocks(e){e.querySelectorAll("div.section > div div").forEach((e=>decorateBlock(e)))}export function buildBlock(e,t){const o=Array.isArray(t)?t:[[t]],a=document.createElement("div");return a.classList.add(e),o.forEach((e=>{const t=document.createElement("div");e.forEach((e=>{const o=document.createElement("div");(e.elems?e.elems:[e]).forEach((e=>{e&&("string"==typeof e?o.innerHTML+=e:o.appendChild(e))})),t.appendChild(o)})),a.appendChild(t)})),a}export async function loadBlock(e,t=!1){if("loading"!==e.getAttribute("data-block-status")&&"loaded"!==e.getAttribute("data-block-status")){e.setAttribute("data-block-status","loading");const o=e.getAttribute("data-block-name");try{const a=new Promise((e=>{loadCSS(`${window.hlx.codeBasePath}/blocks/${o}/${o}.css`,e)})),n=new Promise((a=>{(async()=>{try{const a=await import(`../blocks/${o}/${o}.js`);a.default&&await a.default(e,o,document,t)}catch(e){console.log(`failed to load module for ${o}`,e)}a()})()}));await Promise.all([a,n])}catch(e){console.log(`failed to load block ${o}`,e)}e.setAttribute("data-block-status","loaded")}}export async function loadBlocks(e){updateSectionsStatus(e);const t=[...e.querySelectorAll("div.block")];for(let o=0;o<t.length;o+=1)await loadBlock(t[o]),updateSectionsStatus(e)}export function createOptimizedPicture(e,t="",o=!1,a=[{media:"(min-width: 400px)",width:"2000"},{width:"750"}]){const n=new URL(e,window.location.href),c=document.createElement("picture"),{pathname:i}=n,r=i.substring(i.lastIndexOf(".")+1);return a.forEach((e=>{const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("type","image/webp"),t.setAttribute("srcset",`${i}?width=${e.width}&format=webply&optimize=medium`),c.appendChild(t)})),a.forEach(((e,n)=>{if(n<a.length-1){const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("srcset",`${i}?width=${e.width}&format=${r}&optimize=medium`),c.appendChild(t)}else{const a=document.createElement("img");a.setAttribute("loading",o?"eager":"lazy"),a.setAttribute("alt",t),c.appendChild(a),a.setAttribute("src",`${i}?width=${e.width}&format=${r}&optimize=medium`)}})),c}export function normalizeHeadings(e,t){const o=t.map((e=>e.toLowerCase()));e.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((e=>{const t=e.tagName.toLowerCase();if(-1===o.indexOf(t)){let a=parseInt(t.charAt(1),10)-1;for(;-1===o.indexOf(`h${a}`)&&a>0;)a-=1;if(0===a)for(;-1===o.indexOf(`h${a}`)&&a<7;)a+=1;7!==a&&(e.outerHTML=`<h${a} id="${e.id}">${e.textContent}</h${a}>`)}}))}export function addFavIcon(e){const t=document.createElement("link");t.rel="icon",t.type="image/svg+xml",t.href=e;const o=document.querySelector('head link[rel="icon"]');o?o.parentElement.replaceChild(t,o):document.getElementsByTagName("head")[0].appendChild(t)}export function decorateIcons(e=document){e.querySelectorAll("span.icon").forEach((async e=>{if(e.classList.length<2||!e.classList[1].startsWith("icon-"))return;const t=e.classList[1].substring(5),o=await fetch(`${window.hlx.codeBasePath}${ICON_ROOT}/${t}.svg`);if(o.ok){const t=await o.text();if(t.match(/<style/i)){const o=document.createElement("img");o.src=`data:image/svg+xml,${encodeURIComponent(t)}`,e.appendChild(o)}else e.innerHTML=t}}))}async function waitForLCP(){const e=LCP_BLOCKS,t=document.querySelector(".block");t&&e.includes(t.getAttribute("data-block-name"))&&await loadBlock(t,!0),document.querySelector("body").classList.add("appear");const o=document.querySelector("main img");await new Promise((e=>{o&&!o.complete?(o.setAttribute("loading","eager"),o.addEventListener("load",(()=>e())),o.addEventListener("error",(()=>e()))):e()}))}async function loadPage(e){await loadEager(e),await loadLazy(e),loadDelayed(e)}export function initHlx(){window.hlx=window.hlx||{},window.hlx.lighthouse="on"===new URLSearchParams(window.location.search).get("lighthouse"),window.hlx.codeBasePath="";const e=document.querySelector('script[src$="/scripts/scripts.js"]');if(e)try{[window.hlx.codeBasePath]=new URL(e.src).pathname.split("/scripts/scripts.js")}catch(e){console.log(e)}}initHlx();const LCP_BLOCKS=["marquee","columns"],RUM_GENERATION="helix-website-1",ICON_ROOT="/img";sampleRUM("top"),window.addEventListener("load",(()=>sampleRUM("load"))),document.addEventListener("click",(()=>sampleRUM("click"))),loadPage(document);export function decorateButtons(e=document){const t=["cards"];e.querySelectorAll(":scope a").forEach((e=>{e.title=e.title||e.textContent;const o=e.closest("div.section > div > div");let a;if(o&&(a=o.className),!t.includes(a)&&e.href!==e.textContent){const t=e.parentElement,o=e.parentElement.parentElement;e.querySelector("img")||(1!==t.childNodes.length||"P"!==t.tagName&&"DIV"!==t.tagName||(e.className="button accent",t.classList.add("button-container")),1===t.childNodes.length&&"STRONG"===t.tagName&&1===o.childNodes.length&&"P"===o.tagName&&(e.className="button accent",o.classList.add("button-container")),1===t.childNodes.length&&"EM"===t.tagName&&1===o.childNodes.length&&"P"===o.tagName&&(e.className="button accent light",o.classList.add("button-container")))}}))}export function loadScript(e,t,o){const a=document.createElement("script");return a.onload=t,a.setAttribute("src",e),o&&a.setAttribute("type",o),document.head.append(a),a}export function setTemplate(){const e=getMetadata("template");e&&document.body.classList.add(`${e}-template`)}export function cleanVariations(e){const t=e.querySelectorAll('[class$="-"]');return Array.from(t).map((e=>{const{className:t}=e,o=t.slice(0,-1);e.classList.remove(t);const a=o.split("--");return e.classList.add(...a),e}))}function buildEmbeds(){[...document.querySelectorAll('a[href^="https://www.youtube.com"], a[href^="https://gist.github.com"]')].forEach((e=>{e.replaceWith(buildBlock("embed",e.outerHTML))}))}function buildHeader(){document.querySelector("header").append(buildBlock("header",""))}function buildFooter(){document.querySelector("footer").append(buildBlock("footer",""))}export function buildAutoBlocks(e){try{buildHeader(),buildEmbeds(e),buildFooter()}catch(e){console.error("Auto Blocking failed",e)}}export function decorateMain(e){buildAutoBlocks(e),decorateSections(e),decorateButtons(e),decorateBlocks(e)}async function loadEager(e){const t=e.querySelector("main");t&&(setTemplate(),decorateIcons(),decorateMain(t),await waitForLCP())}async function loadLazy(e){const t=e.querySelector("main"),o=e.querySelector("header > div"),a=e.querySelector("footer > div");loadBlocks(t);const{hash:n}=window.location;n&&setTimeout((()=>{const e=!!n&&t.querySelector(n);e&&e.scrollIntoView()}),500),decorateBlock(o),loadBlock(o),loadCSS("/fonts/fonts.css"),addFavIcon(`${window.hlx.codeBasePath}/img/icon-helix.svg`),decorateBlock(a),loadBlock(a)}function loadDelayed(){}window.name.includes("performance")&&import("./performance.js").then((e=>{e.default&&e.default()}));
